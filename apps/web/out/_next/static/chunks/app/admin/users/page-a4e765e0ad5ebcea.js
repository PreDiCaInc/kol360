(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[674],{2072:function(e,s,n){Promise.resolve().then(n.bind(n,5496))},5496:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return S}});var t=n(6517),l=n(6557),a=n(8012),i=n(1881),r=n(1510),d=n(4017),c=n(4090),o=n(1737),u=n(6944),x=n(1931),m=n(1015),h=n(3887),j=n(8109),f=n(766),p=n(9231),v=n(8875),N=n(7205);let y=j.fC,g=j.xz;j.ZA,j.Uv,j.Tr,j.Ee,l.forwardRef((e,s)=>{let{className:n,inset:l,children:a,...i}=e;return(0,t.jsxs)(j.fF,{ref:s,className:(0,N.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",l&&"pl-8",n),...i,children:[a,(0,t.jsx)(f.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=j.fF.displayName,l.forwardRef((e,s)=>{let{className:n,...l}=e;return(0,t.jsx)(j.tu,{ref:s,className:(0,N.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...l})}).displayName=j.tu.displayName;let I=l.forwardRef((e,s)=>{let{className:n,sideOffset:l=4,...a}=e;return(0,t.jsx)(j.Uv,{children:(0,t.jsx)(j.VY,{ref:s,sideOffset:l,className:(0,N.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...a})})});I.displayName=j.VY.displayName;let A=l.forwardRef((e,s)=>{let{className:n,inset:l,...a}=e;return(0,t.jsx)(j.ck,{ref:s,className:(0,N.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l&&"pl-8",n),...a})});A.displayName=j.ck.displayName,l.forwardRef((e,s)=>{let{className:n,children:l,checked:a,...i}=e;return(0,t.jsxs)(j.oC,{ref:s,className:(0,N.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),checked:a,...i,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(j.wU,{children:(0,t.jsx)(p.Z,{className:"h-4 w-4"})})}),l]})}).displayName=j.oC.displayName,l.forwardRef((e,s)=>{let{className:n,children:l,...a}=e;return(0,t.jsxs)(j.Rk,{ref:s,className:(0,N.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...a,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(j.wU,{children:(0,t.jsx)(v.Z,{className:"h-2 w-2 fill-current"})})}),l]})}).displayName=j.Rk.displayName,l.forwardRef((e,s)=>{let{className:n,inset:l,...a}=e;return(0,t.jsx)(j.__,{ref:s,className:(0,N.cn)("px-2 py-1.5 text-sm font-semibold",l&&"pl-8",n),...a})}).displayName=j.__.displayName;let C=l.forwardRef((e,s)=>{let{className:n,...l}=e;return(0,t.jsx)(j.Z0,{ref:s,className:(0,N.cn)("-mx-1 my-1 h-px bg-muted",n),...l})});C.displayName=j.Z0.displayName;var b=n(8798),w=n(8437),E=n(4733),M=n(5996),D=n(1347),R=n(7229),_=n(7202);function T(e){let{open:s,onOpenChange:n}=e,{user:a}=(0,M.a)(),o=function(){let e=(0,i.NL)();return(0,r.D)({mutationFn:e=>d.x1.post("/api/v1/users/invite",e),onSuccess:()=>{e.invalidateQueries({queryKey:["users"]})}})}(),{data:x}=(0,c.av)(),m=(null==x?void 0:x.items)||[],j=(null==a?void 0:a.role)==="PLATFORM_ADMIN",f=(0,b.cI)({resolver:(0,w.F)(E.createUserSchema),defaultValues:{email:"",firstName:"",lastName:"",role:"TEAM_MEMBER",clientId:null}});async function p(e){try{await o.mutateAsync(e),n(!1),f.reset()}catch(e){console.error("Failed to invite user:",e)}}(0,l.useEffect)(()=>{s&&f.reset({email:"",firstName:"",lastName:"",role:"TEAM_MEMBER",clientId:null})},[s,f]);let v=j?["PLATFORM_ADMIN","CLIENT_ADMIN","TEAM_MEMBER"]:["CLIENT_ADMIN","TEAM_MEMBER"];return(0,t.jsx)(D.Vq,{open:s,onOpenChange:n,children:(0,t.jsxs)(D.cZ,{children:[(0,t.jsx)(D.fK,{children:(0,t.jsx)(D.$N,{children:"Invite User"})}),(0,t.jsx)(R.l0,{...f,children:(0,t.jsxs)("form",{onSubmit:f.handleSubmit(p),className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(R.Wi,{control:f.control,name:"firstName",render:e=>{let{field:s}=e;return(0,t.jsxs)(R.xJ,{children:[(0,t.jsx)(R.lX,{children:"First Name"}),(0,t.jsx)(R.NI,{children:(0,t.jsx)(_.I,{...s,placeholder:"John"})}),(0,t.jsx)(R.zG,{})]})}}),(0,t.jsx)(R.Wi,{control:f.control,name:"lastName",render:e=>{let{field:s}=e;return(0,t.jsxs)(R.xJ,{children:[(0,t.jsx)(R.lX,{children:"Last Name"}),(0,t.jsx)(R.NI,{children:(0,t.jsx)(_.I,{...s,placeholder:"Doe"})}),(0,t.jsx)(R.zG,{})]})}})]}),(0,t.jsx)(R.Wi,{control:f.control,name:"email",render:e=>{let{field:s}=e;return(0,t.jsxs)(R.xJ,{children:[(0,t.jsx)(R.lX,{children:"Email"}),(0,t.jsx)(R.NI,{children:(0,t.jsx)(_.I,{...s,type:"email",placeholder:"john@example.com"})}),(0,t.jsx)(R.zG,{})]})}}),(0,t.jsx)(R.Wi,{control:f.control,name:"role",render:e=>{let{field:s}=e;return(0,t.jsxs)(R.xJ,{children:[(0,t.jsx)(R.lX,{children:"Role"}),(0,t.jsxs)(h.Ph,{onValueChange:s.onChange,value:s.value,children:[(0,t.jsx)(R.NI,{children:(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{})})}),(0,t.jsx)(h.Bw,{children:v.map(e=>(0,t.jsx)(h.Ql,{value:e,children:"PLATFORM_ADMIN"===e?"Platform Admin":"CLIENT_ADMIN"===e?"Client Admin":"Team Member"},e))})]}),(0,t.jsx)(R.zG,{})]})}}),j&&(0,t.jsx)(R.Wi,{control:f.control,name:"clientId",render:e=>{let{field:s}=e;return(0,t.jsxs)(R.xJ,{children:[(0,t.jsx)(R.lX,{children:"Client"}),(0,t.jsxs)(h.Ph,{onValueChange:e=>s.onChange("none"===e?null:e),value:s.value||"none",children:[(0,t.jsx)(R.NI,{children:(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{placeholder:"Select a client"})})}),(0,t.jsxs)(h.Bw,{children:[(0,t.jsx)(h.Ql,{value:"none",children:"No Client (Platform User)"}),m.map(e=>(0,t.jsx)(h.Ql,{value:e.id,children:e.name},e.id))]})]}),(0,t.jsx)(R.zG,{})]})}}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,t.jsx)(u.z,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),(0,t.jsx)(u.z,{type:"submit",disabled:o.isPending,children:o.isPending?"Inviting...":"Send Invitation"})]})]})})]})})}var L=n(4113),F=n(3465),P=n(8959),Q=n(4730);function S(){let[e,s]=(0,l.useState)(!1),[n,j]=(0,l.useState)({}),{data:f,isLoading:v}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{page:s=1,limit:n=20,...t}=e;return(0,a.a)({queryKey:["users",{page:s,limit:n,...t}],queryFn:()=>d.x1.get("/api/v1/users",{page:s,limit:n,...t})})}(n),{data:N}=(0,c.av)(),b=function(){let e=(0,i.NL)();return(0,r.D)({mutationFn:e=>d.x1.post("/api/v1/users/".concat(e,"/approve")),onSuccess:(s,n)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["users",n]})}})}(),w=function(){let e=(0,i.NL)();return(0,r.D)({mutationFn:e=>d.x1.post("/api/v1/users/".concat(e,"/disable")),onSuccess:(s,n)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["users",n]})}})}(),E=function(){let e=(0,i.NL)();return(0,r.D)({mutationFn:e=>d.x1.post("/api/v1/users/".concat(e,"/enable")),onSuccess:(s,n)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["users",n]})}})}(),M=(null==f?void 0:f.items)||[],D=(null==N?void 0:N.items)||[],R=e=>{switch(e){case"ACTIVE":return(0,t.jsx)(x.C,{variant:"default",children:"Active"});case"PENDING_VERIFICATION":return(0,t.jsx)(x.C,{variant:"secondary",children:"Pending"});case"DISABLED":return(0,t.jsx)(x.C,{variant:"destructive",children:"Disabled"});default:return(0,t.jsx)(x.C,{variant:"outline",children:e})}},_=e=>{switch(e){case"PLATFORM_ADMIN":return(0,t.jsx)(x.C,{variant:"default",children:"Platform Admin"});case"CLIENT_ADMIN":return(0,t.jsx)(x.C,{variant:"secondary",children:"Client Admin"});case"TEAM_MEMBER":return(0,t.jsx)(x.C,{variant:"outline",children:"Team Member"});default:return(0,t.jsx)(x.C,{variant:"outline",children:e})}};return(0,t.jsx)(o.Y,{allowedRoles:["PLATFORM_ADMIN","CLIENT_ADMIN"],children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Users"}),(0,t.jsxs)(u.z,{onClick:()=>s(!0),children:[(0,t.jsx)(L.Z,{className:"w-4 h-4 mr-2"}),"Invite User"]})]}),(0,t.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,t.jsxs)(h.Ph,{value:n.clientId||"all",onValueChange:e=>j(s=>({...s,clientId:"all"===e?void 0:e})),children:[(0,t.jsx)(h.i4,{className:"w-48",children:(0,t.jsx)(h.ki,{placeholder:"All Clients"})}),(0,t.jsxs)(h.Bw,{children:[(0,t.jsx)(h.Ql,{value:"all",children:"All Clients"}),D.map(e=>(0,t.jsx)(h.Ql,{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)(h.Ph,{value:n.role||"all",onValueChange:e=>j(s=>({...s,role:"all"===e?void 0:e})),children:[(0,t.jsx)(h.i4,{className:"w-48",children:(0,t.jsx)(h.ki,{placeholder:"All Roles"})}),(0,t.jsxs)(h.Bw,{children:[(0,t.jsx)(h.Ql,{value:"all",children:"All Roles"}),(0,t.jsx)(h.Ql,{value:"PLATFORM_ADMIN",children:"Platform Admin"}),(0,t.jsx)(h.Ql,{value:"CLIENT_ADMIN",children:"Client Admin"}),(0,t.jsx)(h.Ql,{value:"TEAM_MEMBER",children:"Team Member"})]})]}),(0,t.jsxs)(h.Ph,{value:n.status||"all",onValueChange:e=>j(s=>({...s,status:"all"===e?void 0:e})),children:[(0,t.jsx)(h.i4,{className:"w-48",children:(0,t.jsx)(h.ki,{placeholder:"All Statuses"})}),(0,t.jsxs)(h.Bw,{children:[(0,t.jsx)(h.Ql,{value:"all",children:"All Statuses"}),(0,t.jsx)(h.Ql,{value:"ACTIVE",children:"Active"}),(0,t.jsx)(h.Ql,{value:"PENDING_VERIFICATION",children:"Pending"}),(0,t.jsx)(h.Ql,{value:"DISABLED",children:"Disabled"})]})]})]}),v?(0,t.jsx)("div",{children:"Loading..."}):(0,t.jsxs)(m.iA,{children:[(0,t.jsx)(m.xD,{children:(0,t.jsxs)(m.SC,{children:[(0,t.jsx)(m.ss,{children:"Name"}),(0,t.jsx)(m.ss,{children:"Email"}),(0,t.jsx)(m.ss,{children:"Client"}),(0,t.jsx)(m.ss,{children:"Role"}),(0,t.jsx)(m.ss,{children:"Status"}),(0,t.jsx)(m.ss,{className:"w-24",children:"Actions"})]})}),(0,t.jsx)(m.RM,{children:M.map(e=>{var s;return(0,t.jsxs)(m.SC,{children:[(0,t.jsxs)(m.pj,{className:"font-medium",children:[e.firstName," ",e.lastName]}),(0,t.jsx)(m.pj,{children:e.email}),(0,t.jsx)(m.pj,{children:(null===(s=e.client)||void 0===s?void 0:s.name)||"â€”"}),(0,t.jsx)(m.pj,{children:_(e.role)}),(0,t.jsx)(m.pj,{children:R(e.status)}),(0,t.jsx)(m.pj,{children:(0,t.jsxs)(y,{children:[(0,t.jsx)(g,{asChild:!0,children:(0,t.jsx)(u.z,{variant:"ghost",size:"icon",children:(0,t.jsx)(F.Z,{className:"w-4 h-4"})})}),(0,t.jsxs)(I,{align:"end",children:[(0,t.jsxs)(A,{children:[(0,t.jsx)(P.Z,{className:"w-4 h-4 mr-2"}),"Edit"]}),(0,t.jsx)(C,{}),"PENDING_VERIFICATION"===e.status&&(0,t.jsxs)(A,{onClick:()=>b.mutate(e.id),children:[(0,t.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Approve"]}),"ACTIVE"===e.status&&(0,t.jsxs)(A,{onClick:()=>{confirm("Are you sure you want to disable this user?")&&w.mutate(e.id)},className:"text-destructive",children:[(0,t.jsx)(Q.Z,{className:"w-4 h-4 mr-2"}),"Disable"]}),"DISABLED"===e.status&&(0,t.jsxs)(A,{onClick:()=>E.mutate(e.id),children:[(0,t.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Enable"]})]})]})})]},e.id)})})]}),(null==f?void 0:f.pagination)&&(0,t.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",M.length," of ",f.pagination.total," users"]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",f.pagination.page," of ",f.pagination.pages]})]}),(0,t.jsx)(T,{open:e,onOpenChange:s})]})})}},4090:function(e,s,n){"use strict";n.d(s,{Ln:function(){return u},WN:function(){return c},av:function(){return r},eU:function(){return o},m8:function(){return d}});var t=n(8012),l=n(1881),a=n(1510),i=n(4017);function r(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,t.a)({queryKey:["clients",{includeInactive:e}],queryFn:()=>i.x1.get("/api/v1/clients",{includeInactive:e})})}function d(e){return(0,t.a)({queryKey:["clients",e],queryFn:()=>i.x1.get("/api/v1/clients/".concat(e)),enabled:!!e})}function c(){let e=(0,l.NL)();return(0,a.D)({mutationFn:e=>i.x1.post("/api/v1/clients",e),onSuccess:()=>{e.invalidateQueries({queryKey:["clients"]})}})}function o(){let e=(0,l.NL)();return(0,a.D)({mutationFn:e=>{let{id:s,data:n}=e;return i.x1.put("/api/v1/clients/".concat(s),n)},onSuccess:(s,n)=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["clients",n.id]})}})}function u(){let e=(0,l.NL)();return(0,a.D)({mutationFn:e=>i.x1.delete("/api/v1/clients/".concat(e)),onSuccess:()=>{e.invalidateQueries({queryKey:["clients"]})}})}}},function(e){e.O(0,[401,621,465,878,697,662,416,963,744],function(){return e(e.s=2072)}),_N_E=e.O()}]);