(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[174],{8654:function(e,s,l){Promise.resolve().then(l.bind(l,9984))},9984:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return z}});var a=l(6517),n=l(6557),t=l(8949),r=l(301),i=l(1737),c=l(6944),d=l(7202),o=l(1931),h=l(1015),x=l(3887),u=l(1347),m=l(3933);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let p=(0,m.Z)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),j=(0,m.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),g=(0,m.Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),y=(0,m.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function v(e){let{open:s,onOpenChange:l}=e,[t,i]=(0,n.useState)(null),[d,o]=(0,n.useState)(null),h=(0,n.useRef)(null),x=(0,r._2)(),m=async()=>{if(t)try{let e=await x.mutateAsync(t);o(e)}catch(e){console.error("Import failed:",e)}},v=()=>{i(null),o(null),l(!1)};return(0,a.jsx)(u.Vq,{open:s,onOpenChange:v,children:(0,a.jsxs)(u.cZ,{className:"max-w-lg",children:[(0,a.jsxs)(u.fK,{children:[(0,a.jsx)(u.$N,{children:"Import HCPs"}),(0,a.jsx)(u.Be,{children:"Upload an Excel file with HCP data. Existing NPIs will be updated."})]}),d?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,a.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,a.jsx)(g,{className:"w-8 h-8 mx-auto text-green-600 mb-2"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:d.created}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,a.jsx)(g,{className:"w-8 h-8 mx-auto text-blue-600 mb-2"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:d.updated}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Updated"})]}),(0,a.jsxs)("div",{className:"bg-red-50 rounded-lg p-4",children:[(0,a.jsx)(y,{className:"w-8 h-8 mx-auto text-red-600 mb-2"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:d.errors.length}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Errors"})]})]}),d.errors.length>0&&(0,a.jsxs)("div",{className:"bg-red-50 rounded-lg p-4 max-h-48 overflow-y-auto",children:[(0,a.jsx)("p",{className:"font-medium text-red-800 mb-2",children:"Errors:"}),(0,a.jsxs)("ul",{className:"space-y-1 text-sm text-red-700",children:[d.errors.slice(0,10).map((e,s)=>(0,a.jsxs)("li",{children:["Row ",e.row,": ",e.error]},s)),d.errors.length>10&&(0,a.jsxs)("li",{className:"italic",children:["...and ",d.errors.length-10," more errors"]})]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(c.z,{onClick:v,children:"Done"})})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer hover:border-primary transition-colors",onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},onDrop:e=>{var s;e.preventDefault();let l=null===(s=e.dataTransfer.files)||void 0===s?void 0:s[0];l&&(l.name.endsWith(".xlsx")||l.name.endsWith(".xls"))&&(i(l),o(null))},onDragOver:e=>{e.preventDefault()},children:[(0,a.jsx)("input",{type:"file",ref:h,onChange:e=>{var s;let l=null===(s=e.target.files)||void 0===s?void 0:s[0];l&&(i(l),o(null))},accept:".xlsx,.xls",className:"hidden"}),t?(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)(p,{className:"w-8 h-8 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:t.name}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(t.size/1024).toFixed(1)," KB"]})]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)(j,{className:"w-12 h-12 mx-auto text-muted-foreground mb-2"}),(0,a.jsx)("p",{className:"font-medium",children:"Drop Excel file here or click to browse"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Supports .xlsx and .xls files"})]})]}),(0,a.jsxs)("div",{className:"bg-muted/50 rounded-lg p-4 text-sm",children:[(0,a.jsx)("p",{className:"font-medium mb-2",children:"Required columns:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground",children:[(0,a.jsx)("li",{children:"NPI (10 digits)"}),(0,a.jsx)("li",{children:"First Name"}),(0,a.jsx)("li",{children:"Last Name"})]}),(0,a.jsx)("p",{className:"font-medium mt-3 mb-2",children:"Optional columns:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground",children:[(0,a.jsx)("li",{children:"Email, Specialty, Sub-specialty"}),(0,a.jsx)("li",{children:"City, State, Years in Practice"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(c.z,{variant:"outline",onClick:v,children:"Cancel"}),(0,a.jsx)(c.z,{onClick:m,disabled:!t||x.isPending,children:x.isPending?"Importing...":"Import"})]})]})]})})}var f=l(8798),N=l(8437),b=l(4733),C=l(7229);function w(e){let{open:s,onOpenChange:l,hcpId:t}=e,{data:i}=(0,r.h1)(t||""),o=(0,r.cY)(),h=(0,r.Wy)(),x=!!t,m=(0,f.cI)({resolver:(0,N.F)(b.createHcpSchema),defaultValues:{npi:"",firstName:"",lastName:"",email:null,specialty:null,subSpecialty:null,city:null,state:null,yearsInPractice:null}});async function p(e){try{if(x){let{npi:s,...l}=e;await h.mutateAsync({id:t,data:l})}else await o.mutateAsync(e);l(!1),m.reset()}catch(e){console.error("Failed to save HCP:",e)}}return(0,n.useEffect)(()=>{i?m.reset({npi:i.npi,firstName:i.firstName,lastName:i.lastName,email:i.email,specialty:i.specialty,subSpecialty:i.subSpecialty,city:i.city,state:i.state,yearsInPractice:i.yearsInPractice}):t||m.reset({npi:"",firstName:"",lastName:"",email:null,specialty:null,subSpecialty:null,city:null,state:null,yearsInPractice:null})},[i,t,m]),(0,a.jsx)(u.Vq,{open:s,onOpenChange:l,children:(0,a.jsxs)(u.cZ,{className:"max-w-lg",children:[(0,a.jsx)(u.fK,{children:(0,a.jsx)(u.$N,{children:x?"Edit HCP":"Add HCP"})}),(0,a.jsx)(C.l0,{...m,children:(0,a.jsxs)("form",{onSubmit:m.handleSubmit(p),className:"space-y-4",children:[(0,a.jsx)(C.Wi,{control:m.control,name:"npi",render:e=>{let{field:s}=e;return(0,a.jsxs)(C.xJ,{children:[(0,a.jsx)(C.lX,{children:"NPI"}),(0,a.jsx)(C.NI,{children:(0,a.jsx)(d.I,{...s,placeholder:"1234567890",maxLength:10,disabled:x})}),(0,a.jsx)(C.zG,{})]})}}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(C.Wi,{control:m.control,name:"firstName",render:e=>{let{field:s}=e;return(0,a.jsxs)(C.xJ,{children:[(0,a.jsx)(C.lX,{children:"First Name"}),(0,a.jsx)(C.NI,{children:(0,a.jsx)(d.I,{...s,placeholder:"John"})}),(0,a.jsx)(C.zG,{})]})}}),(0,a.jsx)(C.Wi,{control:m.control,name:"lastName",render:e=>{let{field:s}=e;return(0,a.jsxs)(C.xJ,{children:[(0,a.jsx)(C.lX,{children:"Last Name"}),(0,a.jsx)(C.NI,{children:(0,a.jsx)(d.I,{...s,placeholder:"Smith"})}),(0,a.jsx)(C.zG,{})]})}})]}),(0,a.jsx)(C.Wi,{control:m.control,name:"email",render:e=>{let{field:s}=e;return(0,a.jsxs)(C.xJ,{children:[(0,a.jsx)(C.lX,{children:"Email"}),(0,a.jsx)(C.NI,{children:(0,a.jsx)(d.I,{...s,value:s.value||"",onChange:e=>s.onChange(e.target.value||null),type:"email",placeholder:"john@hospital.com"})}),(0,a.jsx)(C.zG,{})]})}}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(C.Wi,{control:m.control,name:"specialty",render:e=>{let{field:s}=e;return(0,a.jsxs)(C.xJ,{children:[(0,a.jsx)(C.lX,{children:"Specialty"}),(0,a.jsx)(C.NI,{children:(0,a.jsx)(d.I,{...s,value:s.value||"",onChange:e=>s.onChange(e.target.value||null),placeholder:"Ophthalmology"})}),(0,a.jsx)(C.zG,{})]})}}),(0,a.jsx)(C.Wi,{control:m.control,name:"subSpecialty",render:e=>{let{field:s}=e;return(0,a.jsxs)(C.xJ,{children:[(0,a.jsx)(C.lX,{children:"Sub-specialty"}),(0,a.jsx)(C.NI,{children:(0,a.jsx)(d.I,{...s,value:s.value||"",onChange:e=>s.onChange(e.target.value||null),placeholder:"Retina"})}),(0,a.jsx)(C.zG,{})]})}})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)(C.Wi,{control:m.control,name:"city",render:e=>{let{field:s}=e;return(0,a.jsxs)(C.xJ,{children:[(0,a.jsx)(C.lX,{children:"City"}),(0,a.jsx)(C.NI,{children:(0,a.jsx)(d.I,{...s,value:s.value||"",onChange:e=>s.onChange(e.target.value||null),placeholder:"Boston"})}),(0,a.jsx)(C.zG,{})]})}}),(0,a.jsx)(C.Wi,{control:m.control,name:"state",render:e=>{let{field:s}=e;return(0,a.jsxs)(C.xJ,{children:[(0,a.jsx)(C.lX,{children:"State"}),(0,a.jsx)(C.NI,{children:(0,a.jsx)(d.I,{...s,value:s.value||"",onChange:e=>s.onChange(e.target.value||null),placeholder:"MA",maxLength:2})}),(0,a.jsx)(C.zG,{})]})}}),(0,a.jsx)(C.Wi,{control:m.control,name:"yearsInPractice",render:e=>{var s;let{field:l}=e;return(0,a.jsxs)(C.xJ,{children:[(0,a.jsx)(C.lX,{children:"Years in Practice"}),(0,a.jsx)(C.NI,{children:(0,a.jsx)(d.I,{type:"number",value:null!==(s=l.value)&&void 0!==s?s:"",onChange:e=>l.onChange(e.target.value?parseInt(e.target.value):null),placeholder:"15"})}),(0,a.jsx)(C.zG,{})]})}})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,a.jsx)(c.z,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),(0,a.jsx)(c.z,{type:"submit",disabled:o.isPending||h.isPending,children:x?"Update":"Create"})]})]})})]})})}var k=l(4113);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let S=(0,m.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),I=(0,m.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var P=l(766);function z(){let[e,s]=(0,n.useState)(!1),[l,u]=(0,n.useState)(!1),[m,p]=(0,n.useState)(""),[g,y]=(0,n.useState)({page:1}),{data:f,isLoading:N}=(0,r.P0)({...g,query:g.query}),{data:b}=(0,r.w_)(),C=(null==f?void 0:f.items)||[],z=null==f?void 0:f.pagination,q=()=>{y(e=>({...e,query:m,page:1}))};return(0,a.jsx)(i.Y,{allowedRoles:["PLATFORM_ADMIN","CLIENT_ADMIN"],children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"HCP Database"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.z,{variant:"outline",onClick:()=>s(!0),children:[(0,a.jsx)(j,{className:"w-4 h-4 mr-2"}),"Import"]}),(0,a.jsxs)(c.z,{onClick:()=>u(!0),children:[(0,a.jsx)(k.Z,{className:"w-4 h-4 mr-2"}),"Add HCP"]})]})]}),(0,a.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex-1 flex gap-2",children:[(0,a.jsx)(d.I,{placeholder:"Search by NPI, name, or alias...",value:m,onChange:e=>p(e.target.value),onKeyPress:e=>{"Enter"===e.key&&q()},className:"max-w-md"}),(0,a.jsx)(c.z,{variant:"outline",onClick:q,children:(0,a.jsx)(S,{className:"w-4 h-4"})})]}),(0,a.jsxs)(x.Ph,{value:g.specialty||"all",onValueChange:e=>y(s=>({...s,specialty:"all"===e?void 0:e,page:1})),children:[(0,a.jsx)(x.i4,{className:"w-48",children:(0,a.jsx)(x.ki,{placeholder:"All Specialties"})}),(0,a.jsxs)(x.Bw,{children:[(0,a.jsx)(x.Ql,{value:"all",children:"All Specialties"}),null==b?void 0:b.specialties.map(e=>(0,a.jsx)(x.Ql,{value:e,children:e},e))]})]}),(0,a.jsxs)(x.Ph,{value:g.state||"all",onValueChange:e=>y(s=>({...s,state:"all"===e?void 0:e,page:1})),children:[(0,a.jsx)(x.i4,{className:"w-32",children:(0,a.jsx)(x.ki,{placeholder:"All States"})}),(0,a.jsxs)(x.Bw,{children:[(0,a.jsx)(x.Ql,{value:"all",children:"All States"}),null==b?void 0:b.states.map(e=>(0,a.jsx)(x.Ql,{value:e,children:e},e))]})]})]}),N?(0,a.jsx)("div",{children:"Loading..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.iA,{children:[(0,a.jsx)(h.xD,{children:(0,a.jsxs)(h.SC,{children:[(0,a.jsx)(h.ss,{children:"NPI"}),(0,a.jsx)(h.ss,{children:"Name"}),(0,a.jsx)(h.ss,{children:"Specialty"}),(0,a.jsx)(h.ss,{children:"Location"}),(0,a.jsx)(h.ss,{children:"Aliases"}),(0,a.jsx)(h.ss,{children:"Campaigns"})]})}),(0,a.jsxs)(h.RM,{children:[C.map(e=>{var s;return(0,a.jsxs)(h.SC,{children:[(0,a.jsx)(h.pj,{className:"font-mono",children:e.npi}),(0,a.jsxs)(h.pj,{children:[(0,a.jsxs)(t.default,{href:"/admin/hcps/".concat(e.id),className:"font-medium text-blue-600 hover:underline",children:[e.firstName," ",e.lastName]}),e.email&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.email})]}),(0,a.jsxs)(h.pj,{children:[e.specialty&&(0,a.jsx)(o.C,{variant:"outline",children:e.specialty}),e.subSpecialty&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:e.subSpecialty})]}),(0,a.jsx)(h.pj,{children:e.city&&e.state?"".concat(e.city,", ").concat(e.state):e.state||"—"}),(0,a.jsx)(h.pj,{children:e.aliases.length>0?(0,a.jsx)(o.C,{variant:"secondary",children:e.aliases.length}):"—"}),(0,a.jsx)(h.pj,{children:(null===(s=e._count)||void 0===s?void 0:s.campaignHcps)||0})]},e.id)}),0===C.length&&(0,a.jsx)(h.SC,{children:(0,a.jsx)(h.pj,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No HCPs found. Try adjusting your search or import some data."})})]})]}),z&&z.pages>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",C.length," of ",z.total," HCPs"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.z,{variant:"outline",size:"sm",disabled:z.page<=1,onClick:()=>y(e=>({...e,page:e.page-1})),children:(0,a.jsx)(I,{className:"w-4 h-4"})}),(0,a.jsxs)("span",{className:"text-sm",children:["Page ",z.page," of ",z.pages]}),(0,a.jsx)(c.z,{variant:"outline",size:"sm",disabled:z.page>=z.pages,onClick:()=>y(e=>({...e,page:e.page+1})),children:(0,a.jsx)(P.Z,{className:"w-4 h-4"})})]})]})]}),(0,a.jsx)(v,{open:e,onOpenChange:s}),(0,a.jsx)(w,{open:l,onOpenChange:u})]})})}},301:function(e,s,l){"use strict";l.d(s,{O6:function(){return m},P0:function(){return i},Wy:function(){return h},_2:function(){return x},cY:function(){return o},h1:function(){return c},w_:function(){return d}});var a=l(8012),n=l(1881),t=l(1510),r=l(4017);function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{page:s=1,limit:l=50,...n}=e;return(0,a.a)({queryKey:["hcps",{page:s,limit:l,...n}],queryFn:()=>r.x1.get("/api/v1/hcps",{page:s,limit:l,...n})})}function c(e){return(0,a.a)({queryKey:["hcps",e],queryFn:()=>r.x1.get("/api/v1/hcps/".concat(e)),enabled:!!e})}function d(){return(0,a.a)({queryKey:["hcps","filters"],queryFn:()=>r.x1.get("/api/v1/hcps/filters")})}function o(){let e=(0,n.NL)();return(0,t.D)({mutationFn:e=>r.x1.post("/api/v1/hcps",e),onSuccess:()=>{e.invalidateQueries({queryKey:["hcps"]})}})}function h(){let e=(0,n.NL)();return(0,t.D)({mutationFn:e=>{let{id:s,data:l}=e;return r.x1.put("/api/v1/hcps/".concat(s),l)},onSuccess:(s,l)=>{e.invalidateQueries({queryKey:["hcps"]}),e.invalidateQueries({queryKey:["hcps",l.id]})}})}function x(){let e=(0,n.NL)();return(0,t.D)({mutationFn:async e=>{let s=new FormData;s.append("file",e);let l=await fetch("".concat("http://localhost:3001","/api/v1/hcps/import"),{method:"POST",body:s,headers:{Authorization:"Bearer ".concat(await p())}});if(!l.ok)throw Error((await l.json()).message||"Import failed");return l.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["hcps"]})}})}let u=null;function m(e){u=e}async function p(){if(u){let e=await u();if(e)return e}throw Error("No auth token available")}},766:function(e,s,l){"use strict";l.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,l(3933).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])}},function(e){e.O(0,[401,621,465,878,949,662,416,963,744],function(){return e(e.s=8654)}),_N_E=e.O()}]);